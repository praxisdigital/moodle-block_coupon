{"version":3,"file":"mailtemplates.min.js","sources":["../../src/mailtemplates/mailtemplates.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\nimport $ from 'jquery';\nimport * as Str from 'core/str';\nimport Notification from 'core/notification';\nimport * as Service from 'block_coupon/mailtemplates/service';\nimport * as DynamicTable from 'core_table/dynamic';\n\n/**\n * Duplicate template\n * @param {Event} e\n */\nconst duplicateTemplate = function(e) {\n    e.preventDefault();\n    const templateId = $(e.currentTarget).attr('data-id');\n    Str.get_strings([\n        {key: 'confirm', component: 'moodle'},\n        {key: 'duplicatetemplateconfirm', component: 'block_coupon', param: $(e.currentTarget).attr('data-name')},\n        {key: 'duplicate', component: 'block_coupon'},\n        {key: 'cancel', component: 'moodle'}\n    ]).done(function(s) {\n        Notification.confirm(s[0], s[1], s[2], s[3], function() {\n            Service.duplicateTemplate(templateId).then((result) => {\n                if (result.result) {\n                    let dt = $(e.currentTarget).closest('.table-dynamic');\n                    if (dt.length) {\n                        DynamicTable.refreshTableContent(DynamicTable.getTableFromId(dt.data('tableUniqueid')));\n                    }\n\n                }\n            });\n        });\n    }).fail(Notification.exception);\n};\n\n/**\n * Delete template\n * @param {Event} e\n */\nconst deleteTemplate = function(e) {\n    e.preventDefault();\n    const templateId = $(e.currentTarget).attr('data-id');\n    Str.get_strings([\n        {key: 'confirm', component: 'moodle'},\n        {key: 'deletetemplateconfirm', component: 'block_coupon', param: $(e.currentTarget).attr('data-name')},\n        {key: 'delete', component: 'moodle'},\n        {key: 'cancel', component: 'moodle'}\n    ]).done(function(s) {\n        Notification.confirm(s[0], s[1], s[2], s[3], function() {\n            Service.deleteTemplate(templateId).then((result) => {\n                if (result.result) {\n                    let dt = $(e.currentTarget).closest('.table-dynamic');\n                    if (dt.length) {\n                        DynamicTable.refreshTableContent(DynamicTable.getTableFromId(dt.data('tableUniqueid')));\n                    }\n                }\n            });\n        });\n    }).fail(Notification.exception);\n};\n\nexport default {\n    init: (selector) => {\n        $(selector).on('click', '[data-action=\"delete\"]', deleteTemplate);\n        $(selector).on('click', '[data-action=\"duplicate\"]', duplicateTemplate);\n    }\n};\n"],"names":["duplicateTemplate","e","preventDefault","templateId","currentTarget","attr","Str","get_strings","key","component","param","done","s","confirm","Service","then","result","dt","closest","length","DynamicTable","refreshTableContent","getTableFromId","data","fail","Notification","exception","deleteTemplate","init","selector","on"],"mappings":"2hDAyBMA,kBAAoB,SAASC,GAC/BA,EAAEC,uBACIC,YAAa,mBAAEF,EAAEG,eAAeC,KAAK,WAC3CC,IAAIC,YAAY,CACZ,CAACC,IAAK,UAAWC,UAAW,UAC5B,CAACD,IAAK,2BAA4BC,UAAW,eAAgBC,OAAO,mBAAET,EAAEG,eAAeC,KAAK,cAC5F,CAACG,IAAK,YAAaC,UAAW,gBAC9B,CAACD,IAAK,SAAUC,UAAW,YAC5BE,MAAK,SAASC,yBACAC,QAAQD,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,IAAI,WACzCE,QAAQd,kBAAkBG,YAAYY,MAAMC,YACpCA,OAAOA,OAAQ,KACXC,IAAK,mBAAEhB,EAAEG,eAAec,QAAQ,kBAChCD,GAAGE,QACHC,aAAaC,oBAAoBD,aAAaE,eAAeL,GAAGM,KAAK,6BAMtFC,KAAKC,sBAAaC,YAOnBC,eAAiB,SAAS1B,GAC5BA,EAAEC,uBACIC,YAAa,mBAAEF,EAAEG,eAAeC,KAAK,WAC3CC,IAAIC,YAAY,CACZ,CAACC,IAAK,UAAWC,UAAW,UAC5B,CAACD,IAAK,wBAAyBC,UAAW,eAAgBC,OAAO,mBAAET,EAAEG,eAAeC,KAAK,cACzF,CAACG,IAAK,SAAUC,UAAW,UAC3B,CAACD,IAAK,SAAUC,UAAW,YAC5BE,MAAK,SAASC,yBACAC,QAAQD,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,IAAI,WACzCE,QAAQa,eAAexB,YAAYY,MAAMC,YACjCA,OAAOA,OAAQ,KACXC,IAAK,mBAAEhB,EAAEG,eAAec,QAAQ,kBAChCD,GAAGE,QACHC,aAAaC,oBAAoBD,aAAaE,eAAeL,GAAGM,KAAK,6BAKtFC,KAAKC,sBAAaC,yBAGV,CACXE,KAAOC,+BACDA,UAAUC,GAAG,QAAS,yBAA0BH,oCAChDE,UAAUC,GAAG,QAAS,4BAA6B9B"}